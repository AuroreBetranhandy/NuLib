!-*-f90-*-
subroutine GaussLegendreQuadrature_weights_and_roots(n,roots,weights)

  implicit none
  
  !inputs
  integer, intent(in) :: n !degree of GaussLegendreQuadrature
  
  !outputs
  real*8, dimension(:), intent(out) :: roots(n) !roots of polynomial, user must be sure the size of array comforms
  real*8, dimension(:), intent(out) :: weights(n) !weights of polynomial, user must be sure the size of array comforms

  select case (n)
  case (4)
     roots = (/-0.861136311594053d0, -0.339981043584856d0, 0.339981043584856d0, &
          0.861136311594053d0/)
     weights = (/0.34785484513745d0, 0.65214515486255d0, 0.65214515486255d0, &
          0.34785484513745d0/)
  case (16)
     roots = (/-0.989400934991650d0, -0.944575023073233d0, -0.865631202387832d0, &
          -0.755404408355003d0, -0.617876244402644d0, -0.458016777657227d0, &
          -0.281603550779259d0, -0.0950125098376374d0, 0.0950125098376374d0, &
          0.281603550779259d0, 0.458016777657227d0, 0.617876244402644d0, &
          0.755404408355003d0, 0.865631202387832d0, 0.944575023073233d0, &
          0.989400934991650d0/)
     weights = (/0.02715245941175d0, 0.06225352393865d0, 0.095158511682493d0, &
          0.124628971255534d0, 0.149595988816577d0, 0.169156519395003d0, &
          0.182603415044924d0, 0.189450610455068d0, 0.189450610455068d0, &
          0.182603415044924d0, 0.169156519395003d0, 0.149595988816577d0, &
          0.12462897125553d0, 0.09515851168249d0, 0.06225352393865d0, &
          0.02715245941175d0/)
  case (32)
     roots = (/-0.997263861849482d0, -0.985611511545268d0, -0.964762255587506d0, &
          -0.934906075937740d0, -0.896321155766052d0, -0.849367613732570d0, &
          -0.794483795967942d0, -0.732182118740290d0, -0.663044266930215d0, &
          -0.587715757240762d0, -0.506899908932229d0, -0.421351276130635d0, &
          -0.331868602282128d0, -0.239287362252137d0, -0.144471961582796d0, &
          -0.0483076656877383d0, 0.0483076656877383d0, 0.144471961582796d0, &
          0.239287362252137d0, 0.331868602282128d0, 0.421351276130635d0, &
          0.506899908932229d0, 0.587715757240762d0, 0.663044266930215d0, &
          0.732182118740290d0, 0.794483795967942d0, 0.849367613732570d0, &
          0.896321155766052d0, 0.934906075937740d0, 0.964762255587506d0, &
          0.985611511545268d0, 0.997263861849482d0/)
     weights = (/0.00701861000947d0, 0.01627439473091d0, 0.025392065309262d0, &
          0.034273862913021d0, 0.042835898022227d0, 0.050998059262376d0, &
          0.058684093478536d0, 0.065822222776362d0, 0.072345794108849d0, &
          0.078193895787070d0, 0.083311924226947d0, 0.087652093004404d0, &
          0.091173878695764d0, 0.093844399080805d0, 0.095638720079275d0, &
          0.096540088514728d0, 0.096540088514728d0, 0.095638720079275d0, &
          0.093844399080805d0, 0.091173878695764d0, 0.087652093004404d0, &
          0.083311924226947d0, 0.078193895787070d0, 0.072345794108849d0, &
          0.065822222776362d0, 0.058684093478536d0, 0.050998059262376d0, &
          0.04283589802223d0, 0.03427386291302d0, 0.02539206530926d0, &
          0.01627439473091d0, 0.00701861000947d0/)
  case (64)
     roots = (/-0.999305041735772d0, -0.996340116771955d0, -0.991013371476744d0, &
          -0.983336253884626d0, -0.973326827789911d0, -0.961008799652054d0, &
          -0.946411374858403d0, -0.929569172131940d0, -0.910522137078503d0, &
          -0.889315445995114d0, -0.865999398154093d0, -0.840629296252580d0, &
          -0.813265315122798d0, -0.783972358943341d0, -0.752819907260532d0, &
          -0.719881850171611d0, -0.685236313054233d0, -0.648965471254657d0, &
          -0.611155355172393d0, -0.571895646202634d0, -0.531279464019895d0, &
          -0.489403145707053d0, -0.446366017253464d0, -0.402270157963992d0, &
          -0.357220158337668d0, -0.311322871990211d0, -0.264687162208767d0, &
          -0.217423643740007d0, -0.169644420423993d0, -0.121462819296121d0, &
          -0.0729931217877990d0, -0.0243502926634244d0, 0.0243502926634244d0, &
          0.0729931217877990d0, 0.121462819296121d0, 0.169644420423993d0, &
          0.217423643740007d0, 0.264687162208767d0, 0.311322871990211d0, &
          0.357220158337668d0, 0.402270157963992d0, 0.446366017253464d0, &
          0.489403145707053d0, 0.531279464019895d0, 0.571895646202634d0, &
          0.611155355172393d0, 0.648965471254657d0, 0.685236313054233d0, &
          0.719881850171611d0, 0.752819907260532d0, 0.783972358943341d0, &
          0.813265315122798d0, 0.840629296252580d0, 0.865999398154093d0, &
          0.889315445995114d0, 0.910522137078503d0, 0.929569172131940d0, &
          0.946411374858403d0, 0.961008799652054d0, 0.973326827789911d0, &
          0.983336253884626d0, 0.991013371476744d0, 0.996340116771955d0, &
          0.999305041735772d0/)
     weights = (/0.00178328072170d0, 0.00414703326056d0, 0.006504457968978d0, &
          0.008846759826364d0, 0.011168139460131d0, 0.013463047896719d0, &
          0.015726030476025d0, 0.017951715775698d0, 0.020134823153530d0, &
          0.022270173808383d0, 0.024352702568711d0, 0.026377469715055d0, &
          0.028339672614259d0, 0.030234657072402d0, 0.032057928354852d0, &
          0.033805161837142d0, 0.035472213256882d0, 0.037055128540240d0, &
          0.038550153178616d0, 0.039953741132720d0, 0.041262563242624d0, &
          0.042473515123654d0, 0.043583724529323d0, 0.044590558163757d0, &
          0.045491627927418d0, 0.046284796581314d0, 0.046968182816210d0, &
          0.0475401657148303d0, 0.0479993885964583d0, 0.0483447622348030d0, &
          0.0485754674415034d0, 0.0486909570091397d0, 0.0486909570091397d0, &
          0.0485754674415034d0, 0.0483447622348030d0, 0.0479993885964583d0, &
          0.0475401657148303d0, 0.046968182816210d0, 0.046284796581314d0, &
          0.045491627927418d0, 0.044590558163757d0, 0.043583724529323d0, &
          0.042473515123654d0, 0.041262563242624d0, 0.039953741132720d0, &
          0.038550153178616d0, 0.037055128540240d0, 0.035472213256882d0, &
          0.033805161837142d0, 0.032057928354852d0, 0.030234657072402d0, &
          0.028339672614259d0, 0.026377469715055d0, 0.024352702568711d0, &
          0.022270173808383d0, 0.020134823153530d0, 0.017951715775698d0, &
          0.015726030476025d0, 0.013463047896719d0, 0.01116813946013d0, &
          0.00884675982636d0, 0.00650445796898d0, 0.00414703326056d0, &
          0.00178328072170d0/)
  case default
     stop "GaussLegendreQuadrature_weights_and_roots: with this n is not defined"
  end select
        
end subroutine GaussLegendreQuadrature_weights_and_roots
